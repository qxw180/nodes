# Code Review

CR 可以让每次提交代码都在使仓库变的更好

1. 在需求提交前发现 bug
2. 代码分享和知识交流
3. 利于团队，每个人都对整个项目熟悉，避免个别需求和个别人的强绑定

## checklist

- 是否已有现成代码可复用后扩展已有代码
- 是否可以进一步抽象封装
- 是否移除了调试代码
- 是否可以进一步拆分 MR
- commit 描述是否足够清醒
- 是否添加必要注释
- 命名是否合理
- 是否有安全问题
- 是否有坏味道
- 是否有必要的自动化测试

## 在 CR 之前要提前执行自动化审查

- 代码规范检查
- 代码复杂度检查
- 自动化测试

## rule

1. import
   1. 不要`import`和`require`混用，推荐使用 ESM
   2. 同一个文件不要多次`import`
   3. 未使用的`import`需要被清理
   4. import 尽量使用完整路径，不要使用相对路径、推荐使用 alias，设计要有一致性和可读性
   5. import 顺序、不要使用 import
   6. import 外部依赖命名语义不明确的情况要适当添加注释
2. 命名
   1. 文件命名使用 kebab-case 方式，即`xxx-xxx`，全小写`-`代替空格
   2. 组件使用 PascalCase 方式命名，即`XxxXxx`，首字母大写
   3. 函数使用 camelCase 方式命名，即`xxxXxxx`，第一个单词消息，后续单词首字母大写
   4. 文件、函数、类命名要有意义、保持一致性、避免无意义的前后缀
   5. class 变量要明确声明变量的`public`、`private`、`protected`
   6. 布尔类型变量命名使用：`is|should`前缀
3. 代码组织
   1. 文件命名要有一致性，即合理通用的代码目录组织及命名
   2. 工具函数适当的归类、便于理解，避免形成垃圾桶文件，把所有的公用函数都堆积到一个代码文件内管理
4. 函数
   1. 异常优先，优先处理异常逻辑，可以降低代码缩进
   2. 代码组织顺序不符合阅读顺序，核心内容上提，私有类和方法下移
   3. 类内变量函数同上
   4. 要有适当的换行和注释
   5. 函数过长
      1. 阶段拆分
      2. 循环拆分
      3. 卫语句改下 if 嵌套
      4. 复杂 if 条件提取成函数，可以通过函数名理解判断逻辑
5. 其它
   1. 删除无意义注释代码
   2. 合理使用换行，段落化代码
   3. 不推荐使用`export default`导出，因为引用人可以进行重命名、如果使用类名应该和文件名一致
   4. 避免魔术字符串的无意义硬编码，使用枚举替代
   5. 不能使用全局变量
6. React
   1. React 使用箭头函数替换 bind 绑定
   2. 未使用 this 的函数不适应作为成员函数存在，可以提前单独提取
7. 异步
   1. 使用异步函数替换 callback
