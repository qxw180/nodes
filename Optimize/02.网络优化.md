#前端性能优化-网络相关

##网页加载渲染流程
+ Step1、DNS寻址及IP解析
+ Step2、TCP链接
+ Step3、请求、响应、文档下载
    * 同步加载
    * 分级加载
    * 按需加载
+ Step4、文档解析渲染
    * 4.1 DOM树生成
    * 4.2 Render树生成
    * 4.3 加载外部资源、渲染页面

##网络延迟
+ 浏览器阻塞：浏览器对应同一个域名，同时最多建立4个连接，不同浏览器内核会有所不同，当请求数量超过最大限制后，后面的请求会被阻塞
+ DNS查询：获取域名对应的IP值
+ 建立连接：HTTP基于TCP连接，需要先建立连接才能进行请求

##性能优化方向
+ DNS优化
+ 避免页面跳转
+ 减少请求数
    * 代码合并
    * 雪碧图
    * 内联图片
+ 资源压缩优化
    * Gzip
    * 代码合并压缩混淆
    * 图片压缩
+ 利用缓存
    * 静态文件缓存
    * ETag
+ 优化资源加载顺序
    * 延迟加载
    * 预加载
+ 使用CDN
+ 图片优化



##CDN
对于来自同一个域名的资源，比如脚本文件、样式表文件、图片文件等，浏览器一般最多同时下载多个（IE11允许同时下载13个）。如果是来自不同域名的资源，就没有这个限制。所以，通常把静态文件放在不同的域名之下，以加快下载速度。
// TODO
合理利用CDN，减少DNS查询，如果全部使用相同域名会影响并行下载数据量，控制在2-4个。

##DNS Prefetching
DNS预解析，客户端可以提前进行DNS解析并缓存，之后的请求可以直接使用缓存，提升速度页面加载速度。
浏览器默认会自动扫描当前页面中domain并进行DNS解析，这个解析过程不会阻碍页面的渲染。
一般情况下浏览器仅会扫描HTML页面中出现的domain，在HTML之外的domain(例如JavaScript请求、或者是站点内其他页面使用的DNS)浏览器不会自动进行预加载。
我们可以设置预解析列表，如下：
``` HTML
<link rel="dns-prefetch" href="//example.com">
<link rel="dns-prefetch" href="https://ajax.googleapis.com">
```

##利用本地缓存
// TODO









