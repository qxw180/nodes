# 装饰器

装饰器是一个函数，然后使用`@装饰器函数`修饰被装饰对象，以达到不修改原始代码实现添加(修改)功能的目的。安装被修饰对象可以分为：

1. 类装饰器
2. 属性装饰器
3. 方法装饰器
4. 参数装饰器

## 类装饰器

接收一个参数`target`即类本身

```JavaScript
function decoratorDemo(target) {
  target.isDec = true;
}

@decoratorDemo
class Demo {}
console.log(Demo.idDec); // true
```

还可以结合高阶函数给装饰器传参

```JavaScript
function decoratorDemo(idDec) {
  return function (target) {
    target.isDec = isDec;
  };
}

@decoratorDemo(true)
class Demo {}

console.log(Demo.idDec); // true
```

## 方法装饰器

接收三个属性：

- `target`：类实例
- `key`：方法名
- `descriptor`：方法描述符

```JavaScript
function InjectPrefix(prefix: string) {
  return function(target, key, descriptor) {
    const val = descriptor.value
    descriptor.value = function(...args) {
      return val(prefix + args[0])
    }
    return descriptor
  }
}

class Demo {
  @InjectPrefix('Mike-')
  log(x) {
    console.log(x)
  }
}

const demo = new Demo()
demo.log('Jordan'); // Mike-Jordan
```

## 属性装饰器

结算两个参数：类的实例`target`和属性名称`key`

```JavaScript
class Prop {
  @init(16)
  age: number
}

function init(age: number) {
  return function(target, key) {
    target[key] = age
    return target
  }
}

const prop = new Prop
console.log(prop.age)
```

## 参数装饰器

接收三个属性：

- `target`：类实例
- `key`：方法名
- `index`：参数下标

```JavaScript

```

## 参考

[JS 装饰器，一篇就够](https://segmentfault.com/a/1190000014495089)
