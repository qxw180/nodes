# Vue 数据绑定

## 单项数据绑定`v-bind`

## 双向数据绑定`v-model`

**`v-model`双向数据绑定只能应用在表单类元素（有`value`的输入类元素）上**

## 数据代理

通过一个对象对另一个对象中的属性进行操作

```JS
let o1 = {x: 1};
let o2 = {y: 2};

Object.defineProperty(o2, 'x', {
  get() {
    return o1.x;
  },
  set(val) {
    o1.x = val;
  }
})
```

Vue 中的 Model 是通过数据代理到 vue 实例对象，通过 vm 对象来代理`data`中的额属性操作（读/写），通过数据代理可以更加方便的操作 data 中的数据。
Vue 使用`Object.defineProperty`把`data`中的每一个属性都代理到 vm 对象上。

```vue
<template>
  <!-- 以下写法都可以获取data中的name值 -->
  <p>{{ name }}</p>
  <p>{{ _data.name }}</p>
</template>
<script>
export default {
  data: { name: "Vue" },
};
</script>
```

## 数据劫持：Vue 数据变化监测

Vue 会将监测 data 中所有层数的数据变化

Vue 监测**对象数据变化**是通过代理数据的`set`方法实现

```js
const data = { a: 1, b: 2 };

function Observer(obj) {
  const keys = Object.keys(obj);

  keys.forEach((key) => {
    Object.defineProperty(this, k, {
      get() {
        return obj[k];
      },
      set(val) {
        // 在此可以实现监测数据变化、触发模板解析等功能
        obj[key] = val;
      },
    });
  });
}

const obs = new Observer(data);

const vm = {};
vm._data = data = obs;
```

Vue 通过包装 Vue 实例上数组的`push、pop、shift、unshift、slice、sort、reverse`方法实现数组对象数据变化
所以直接修改数组元素不能实现响应式，例：`this.friends[0] = {name: 'lee'}`，页面不会更新

## 双向数据绑定

TODO:双向数据绑定如何避免死循环？

## 响应式

选项式：使用`data`属性声明，`data`是一个返回对象的函数，vue 会对对象进行响应式包装并代理到组件实例上，后添加到组件实例的属性变化无法触发响应式更新。

组合式：可以使用`reactive`创建响应式的对象或数组

```JS
import { reactive } from 'vue'
const state = reactive({ count: 0 })
```

## 响应式和模板重新解析

以下场景会触发模板重新解析

- data 变化
