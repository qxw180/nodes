#JavaScript 模块化
> 模块化是一种编程方式，每个文件都是一个模块。

##JavaScript开发方式演变
1. 刀耕火种，最原始的方式，一个人实现所有代码功能，通常在直接写到HTML中或者提取到一个js文件中；
2. 重复利用，代码写的多了发现很多代码都是重复的，于是把这些代码提取出来，每次使用的时候只需要引用一下就可以。很多人也把自己的代码共享给其它人使用；
3. 模块化组织，渐渐的前端页面的功能越来越丰富，新的问题也暴漏了出来。
	1. 引入的js文件也越来越多，代码臃肿，页面加载时产生大量的HTTP请求；
	2. 因为javascrip本身没有提供模块机制，所有变量默认都挂载到全局变量`windows`对象下，多个模块之间变量命名冲突。
	3. 而且模块之间是存在依赖关系的，必须按照顺序进行加载；
4. 为了解决以上问题，前端模块化规范和模块化管理器应运而生，管理*变量冲突*和*依赖关系*；
	1. AMD规范：[requirejs](http://requirejs.org/)
	2. CMD规范：seajs
	3. commonJS：Node、Browerify、Dou


##模块化简单实现[参考](http://www.ruanyifeng.com/blog/2012/10/javascript_module.html)

##### 对象写法
> 定义一个对象，所有模块均挂载到该对象上
	var module = {
		_priv: 0,
		v1: 100,
		f1: function(){},
		f2: function(){}
	}

	module.f1();
解决了全局变量污染问题；缺点会暴露模块程序，模块内部成员可以被修改；

##### 立即执行函数 IIFE
> 利用javascrip作用域和闭包，使用立即执行函数将对外开放的模块作为返回值挂载到外部变量
	var module = (function(){
		var _count: 0;
		var f1 = function(){}	
		var f2 = function(){}	

		return {
			f1: f1,
			f2: f2
		}
	})()
缺点模块无法拆分，功能多时模块过大；无法实现模块依赖；

##### 放大模式
> 将依赖的模块作为参赛传人模块，这样可以进一步实现模块的拆分
	var module = (function(mod){
		mod.f3 = function(){};
		return mod;
	})(module)
	
	(function(mod){

	})(module2)

在浏览器中各模块的加载顺序不确定，

##### 宽放大模式
	var module1 = (function(module){
		return module
	})(window.module1 || {})
在浏览器环境中，模块的各个部分通常都是从网上获取的，有时无法知道哪个部分会先加载。如果采用上一节的写法，第一个执行的部分有可能加载一个不存在空对象，这时就要采用"宽放大模式"。



##JavaScript模块化规范

####CommngJS
模块同步加载规范，模块加载完成后执行
因为NodeJs主要用于服务器编程，模块位于本地硬盘，加载笔记不需要考虑异步情况，所以适合采用CommonJS规范
+ 一个js文件就是一个模块
+ 模块最后返回一个exports对象
+ 使用require方法加载模块
+ 加载模块后执行，最后获取模块的exports对象

	// 模块定义 example.js
	exports = {
		message:'CommonJs Module Demo',
		sayHello: function(){
			console.log("Hello CommonJS");
		}
	}
	// 模块加载
	var example = require('example.js');
	example.sayHello(); // Hello CommonJS


####AMD
模块异步加载规范，允许指定回调函数
浏览器环境下需要通过网络从服务器加载模块，要考虑异步情况，所以采用AMD规范比较合适
+ 通过`define`函数定义模块
	* 第一个参数为依赖的模块
	* 第二个参数为回调函数，依赖模块加载完成后执行
+ 通过`require`函数加载模块，参数同`define`函数

	// 定义模块 example.js
	define([package/lib],function(lib){
		function foo(){
			lib.sayHello();
		}

		return {
			foo: foo
		}
	});
	// 加载模块
	require(['example'],function(example){
		example.foo();
	})

